<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factibilidad de Giro</title>

    <link rel="stylesheet" href="css/factibilidadGiro.css">
    <link rel="stylesheet" href="css/ubiGiro.css">
    <link rel="stylesheet" href="css/docsGiro.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>

<img src="images/images/slide OBRAS P√öBLICAS Y DESARROLLO URBANO.png" alt="desarrollo social" class="header-image">

<div class="titulo-tramite">
    <h1>Tr√°mite de Factibilidad de Giro</h1>
</div>

<style>
  /* Bot√≥n de pago */
.btnPagarMiTramite {
  background-color: #0b3b60;
  color: #ffffff;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s ease, transform 0.2s ease;
}

.btnPagarMiTramite:hover {
  background-color: #0b3b60;
}
</style>


<body>
           <!--*********************************************************************************-->
           <!--***************************FORMULARIO DE FACTIBILIDAD****************************-->
           <!--*********************************************************************************-->
    
          <div class="containerFormTramiteFactGiro">
              <!-- FORMULARIO -->
      <div class="contTramiteFactGiro">
        <div class="stepperFactGiro">
          <div class="stepFactGiro" data-step="1">
            <div class="circle">1</div>
            <span>Datos de identificaci√≥n</span>
          </div>
          <div class="lineFactGiro"></div>
          <div class="stepFactGiro" data-step="2">
            <div class="circle">2</div>
            <span>Ubicaci√≥n del predio</span>
          </div>
          <div class="lineFactGiro"></div>
          <div class="stepFactGiro" data-step="3">
            <div class="circle">3</div>
            <span>Factibilidad de giro</span>
          </div>
          <div class="lineFactGiro"></div>
          <div class="stepFactGiro" data-step="4">
            <div class="circle">4</div>
            <span>Documentaci√≥n</span>
          </div>
          <div class="lineFactGiro"></div>
          <div class="stepFactGiro" data-step="5">
            <div class="circle">5</div>
            <span>Payment</span>
          </div>
        </div>
    
        <!-- Formulario FactGiro -->
        <form id="stepFormFactGiro">
          <!-- Paso 1 -->
          <div class="form-step activeFactGiro" data-step="1">
            <h2>Datos del propiertario(s)</h2>
            <p>
              Favor de completar todos los campos con la informaci√≥n correspondiente a cada campo del formulario,
              los campos con el identificador (<span style="color: red">*</span>) quiere decir que son obligatorios para seguir avanzando
              con el tr√°mite
            </p>
            <div class="form-group-tramite">
            <div id="formularioPrincipal">
              
              <div class="formGroup">
                  <label for="superficie">Superficie de terreno en m¬≤ (<span style="color: red">*</span>)</label>
                  <input type="text" id="superficie" name="superficie" required  oninput="validarSoloNumeros('superficie')"/>
              </div>
          
              <div class="formGroup">
                  <label for="claveCatastral">Clave Catastral (<span style="color: red">*</span>)</label>
                  <input type="text" id="claveCatastral" name="claveCatastral" required oninput="validarClaveCatastral('claveCatastral')"/>
              </div>
          
              <div class="formGroup">
                  <label for="razonSocial">Raz√≥n Social (<span style="color: red">*</span>)</label>
                  <input type="text" id="razonSocial" name="razonSocial"required oninput="validarRazonSocial('razonSocial')" />
              </div>
          
              <div class="formGroup">
                  <label for="apellidoPaterno">Apellido Paterno (<span style="color: red">*</span>)</label>
                  <input type="text" id="apellidoPaterno" name="apellidoPaterno" required oninput="validarNombreApellido('apellidoPaterno')"/>
              </div>
          
              <div class="formGroup">
                  <label for="apellidoMaterno">Apellido Materno (<span style="color: red">*</span>)</label>
                  <input type="text" id="apellidoMaterno" name="apellidoMaterno" required oninput="validarNombreApellido('apellidoMaterno')"/>
              </div>
          
              <div class="formGroup">
                  <label for="nombre">Nombre(s) (<span style="color: red">*</span>)</label>
                  <input type="text" id="nombre" name="nombre"required oninput="validarNombreApellido('nombre')" />
              </div>
          
              <div class="formGroup">
                  <label for="telefono">Tel√©fono (<span style="color: red">*</span>)</label>
                  <input type="tel" id="telefono" name="telefono"required oninput="validarTelefono('telefono')" />
              </div>
          
              <div class="formGroup">
                  <label for="correo">Correo electr√≥nico (<span style="color: red">*</span>)</label>
                  <input type="text" id="correo" name="correo" required oninput="validarCorreo('correo')"/>
              </div>
          
              <div class="formGroup">
                  <label for="personaAutorizada">Persona autorizada para recibir notificaciones o resoluciones (<span style="color: red">*</span>)</label>
                  <input type="text" id="personaAutorizada" name="personaAutorizada" oninput="validarNombreApellido('personaAutorizada')"/>
              </div>
          </div>
            </div>

            <div class="form-navigation">
                <div></div>
              <button type="button" class="btnNextFactGiro">siguiente</button>
            </div>
          </div>
    
          <!-- Paso 2 -->
          <div class="form-step" data-step="2">
            <h2>Ubicaci√≥n del predio</h2>
            <div class="form-group-tramite">
              <div id="contenedor-mapa">
                <p>
                  Para saber la ubicaci√≥n del predio, favor de llenar
                  los campos en orden num√©rico con los datos requeridos con el
                  simbolo (<span style="color: red">*</span>), una vez
                  completada la informaci√≥n, dar√°s clic en el bot√≥n (Buscar
                  ubicaci√≥n) y el mapa mostrar√° la ubicaci√≥n con respecto a la
                  informaci√≥n brindada, deber√° verificar que la ubicaci√≥n este
                  correctamente establecida con un marcador color rojo, en caso
                  de que el cursor rojo se encuentre en otra posici√≥n, puede
                  hacer zoom al mapa y dar clic en la posici√≥n correcta y el
                  cursor se mover√° a la ubicaci√≥n correcta.
                </p>
                <div id="contenidoUbi">
                  <div class="input-columns">
                    <label>
                      1. C√≥digo postal (<span style="color: red">*</span>):
                      <input
                        id="codigoPostal"
                        type="text"
                        name="codigoPostal"
                        placeholder="C√≥digo postal"
                        onblur="buscarColonias()"
                        oninput="validarCodigoPostal('codigoPostal')"
                        class="sin-tildes solo-numeros" required
                      />
                    </label>
                    <label style="position: relative">
                      2. Nombre de la colonia/comunidad (<span
                        style="color: red"
                        >*</span
                      >):
                      <input
                        id="colonia"
                        type="text"
                        name="colonia"
                        placeholder="Escribe o selecciona una Colonia/Fraccionamiento"
                        onclick="mostrarAutocomplete()"
                        oninput="validarColonia('colonia')"
                        class="sin-tildes solo-letras-numeros"
                        style="padding-right: 30px" required
                      />
                      <div
                        id="autocomplete-list"
                        class="autocomplete-items hidden"
                      ></div>
                    </label>
                  </div>

                  <div class="input-columns">
                    <label>
                      3. Calle (<span style="color: red">*</span>):
                      <input
                        id="calle"
                        type="text"
                        name="calle"
                        placeholder="Calle"
                        oninput="validarCalle('calle')"
                        class="sin-tildes solo-letras-numeros" required
                      />
                    </label>
                    <label>
                      4. N√∫mero exterior (<span style="color: red">*</span>):
                      <input
                        id="numeroExterior"
                        type="text"
                        name="numeroExterior"
                        placeholder="N√∫mero exterior"
                        oninput="validarNumeroExterior('numeroExterior')"
                        class="sin-tildes solo-letras-numeros" required
                      />  
                    </label>
                  </div>

                  <div class="input-columns">
                    <label>
                      5. N√∫mero interior:
                      <input
                        id="numeroInterior"
                        type="text"
                        name="numeroInterior"
                        placeholder="N√∫meroInterior"
                        oninput="validarNumeroInterior('numeroInterior')"
                        class="sin-tildes solo-letras-numeros" 
                      />
                    </label>
                  </div>
                  <br>

                  <button
                    type="button"
                    id="btn-buscarUbi"
                    onclick="buscarUbicacion()"
                  >
                    <i class="fas fa-search-location"></i> Buscar ubicaci√≥n
                  </button>
                  <small
                    id="mensaje-error"
                    style="color: red; display: none; margin-top: 10px"
                  ></small>

                  <div id="map"></div>
                  <div
                    id="guardar-ubicacion-container"
                    style="display: none; margin-top: 20px">
                  </div>

                  <div class="latlong-columns">
                    <label
                      >Latitud:
                      <input
                        id="latitud"
                        type="text"
                        name="latitud"
                        placeholder="Latitud"
                        readonly 
                        required
                      />
                    </label>
                    <label
                      >Longitud:
                      <input
                        id="longitud"
                        type="text"
                        name="longitud"
                        placeholder="Longitud"
                        readonly 
                        required
                      />
                    </label>
                  </div>
                </div> 
              </div>
            </div>
            <div class="form-navigation">
              <button type="button" class="btnPrevFactGiro">Volver</button>
              <button type="button" class="btnNextFactGiro">Siguiente</button>
            </div>
          </div>
    
          <!-- Paso 3 -->
          <div class="form-step" data-step="3">
            <h2>Factibilidad de giro</h2>
            <div class="form-group-tramite">
                
              <label for="arrendatario">1.- Nombre o raz√≥n social del interesado(arrendatario) (<span style="color: red">*</span>)</label>
              <input type="text" id="arrendatario" name="arrendatario" oninput="validarDescripcion('arrendatario')"/>

              <label for="superficieLocal">2.- Superficie del local en m¬≤(<span style="color: red">*</span>)</label>
              <input type="text" id="superficieLocal" name="superficieLocal"  oninput="validarSoloNumeros('superficieLocal')"/>
    
              <label for="descAct">3.- Descripci√≥n de la actividad (<span style="color: red">*</span>)</label>
                <input type="text" id="descAct" name="descAct" oninput="validarDescripcion('descAct')"/>
            </div>
            <div id="containerTipoSolicitud">
              <label id="labelTipoSolicitud">2.- Tipo de Solicitud (<span style="color: red">*</span>)</label>
              <div id="radioGroupTipoSolicitud">
                  <label class="radioLabelTipoSolicitud">
                      <input type="radio" name="tipoSolicitud" value="NUEVO" onchange="validarRadioGrupo('tipoSolicitud', 'containerTipoSolicitud')">
                      <span>Nuevo</span>
                  </label>
                  <label class="radioLabelTipoSolicitud">
                    <input type="radio" name="tipoSolicitud"  value="MODIFICACION" onchange="validarRadioGrupo('tipoSolicitud', 'containerTipoSolicitud')">
                    <span>Modificaci√≥n</span>
                </label>
                  <label class="radioLabelTipoSolicitud">
                      <input type="radio" name="tipoSolicitud" value="RATIFICACION" onchange="validarRadioGrupo('tipoSolicitud', 'containerTipoSolicitud')">
                      <span>Ratificaci√≥n</span>
                  </label>
              </div>
          </div>
          
            <br>
            <div id="containerTipoFactibilidad">
              <label id="labelTipoFactibilidad"> 3.- Uso Solicitud (<span style="color: red">*</span>)</label>
              <div id="radioGroupTipoFactibilidad">
                  <label class="radioLabelTipoFactibilidad">
                      <input type="radio" name="tipoFactibilidad" value="HABITACIONAL" onchange="validarRadioGrupo('tipoFactibilidad', 'containerTipoFactibilidad')">
                      <span>Habitacional</span>
                  </label>
                  <label class="radioLabelTipoFactibilidad">
                      <input type="radio" name="tipoFactibilidad" value="COMERCIAL" onchange="validarRadioGrupo('tipoFactibilidad', 'containerTipoFactibilidad')">
                      <span>Comercial</span>
                  </label>  
                  <label class="radioLabelTipoFactibilidad"> 
                      <input type="radio" name="tipoFactibilidad" value="SERVICIOS" onchange="validarRadioGrupo('tipoFactibilidad', 'containerTipoFactibilidad')">
                      <span>Servicios</span>
                  </label>
                  <label class="radioLabelTipoFactibilidad">
                      <input type="radio" name="tipoFactibilidad" value="INDUSTRIAL" onchange="validarRadioGrupo('tipoFactibilidad', 'containerTipoFactibilidad')">
                      <span>Industrial</span>
                  </label>
              </div>
          </div>
          <br>
            <div class="form-navigation">
              <button type="button" class="btnPrevFactGiro">Volver</button>
              <button type="button" class="btnNextFactGiro">Siguiente</button>
            </div>
          </div>
    
          <!-- Paso 4 -->
          <div class="form-step" data-step="4">
            <h2>Documentaci√≥n Factibilidad de Giro</h2>
            
            <!-- Tabla de Documentos Generales -->
            <h3>Documentos Generales</h3>
            <div class="table-container">
                <table id="tablaDocsGenerales" class="styled-table">
                    <thead>
                        <tr>
                            <th>üìÑ Ver Archivo</th>
                            <th>üìú Nombre Documento</th>
                            <th>üìù Descripci√≥n</th>
                            <th>üìè Tama√±o</th>
                            <th>‚öô Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
         
            <!-- Tabla de Documentos Condicionales -->
            <h3>Documentos Condicionales</h3>
            <div class="table-container">
                <table id="tablaDocsCondicionales" class="styled-table">
                    <thead>
                        <tr>
                            <th>üìÑ Ver Archivo</th>
                            <th>üìú Nombre Documento</th>
                            <th>üìù Descripci√≥n</th>
                            <th>üìè Tama√±o</th>
                            <th>‚öô Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
         
            <!-- Tabla de Documentos Espec√≠ficos -->
            <h3>Documentos Espec√≠ficos</h3>
            <div class="table-container">
                <table id="tablaDocsEspecificos" class="styled-table">
                    <thead>
                        <tr>
                            <th>üìÑ Ver Archivo</th>
                            <th>üìú Nombre Documento</th>
                            <th>üìù Descripci√≥n</th>
                            <th>üìè Tama√±o</th>
                            <th>‚öô Acciones</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div> 
             <div class="form-navigation">
              <button type="button" class="btnPrevFactGiro">Volver</button>
              <!--<button type="button" data-btn="insertAndUploadGiro" class="btnNextFactGiro">Siguiente</button>-->
              <button type="button"  class="btnNextFactGiro">Siguiente</button>
            </div>
          </div>
    
           <!-- Paso 5 Proceder a pagar -->
           <div class="form-step" data-step="7">
            <h2>Realiza el pago de tu tr√°mite</h2>
            <p class="confirmacion">Tus datos para el registro de la acu√°tica Manuel G√≥mez Mor√≠n han sido enviados exitosamente.</p>
            <p>Para completar el tr√°mite es necesario realizar el pago</p>

            <!-- Bot√≥n que se ocultar√° una vez que demos clic -->
            <button class="btnPagarMiTramite" data-tramite="giro">
              Pagar mi tr√°mite
            </button>

            <!-- Contenedor donde insertaremos el iframe; oculto por defecto -->
            <div id="iframePagoContainer" style="display: none; margin-top: 20px;">
              <!-- Aqu√≠ se inyectar√° el iframe din√°micamente -->
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal de advertencia para validaci√≥n de campos -->
<div id="modalValidarCampos" class="modal-validar-campos">
  <div class="modal-content-validar">
      <span class="close-modal-validar">&times;</span>
      <img src="./images/images/advertencia.png" alt="Advertencia" class="icono-advertencia-validar">
      <p>Por favor, completa todos los campos obligatorios con la informaci√≥n correcta para poder avanzar.</p>
      <button id="cerrarModalValidar">Entendido</button>
  </div>
</div>   

<script>

const btnPagar = document.querySelector(".btnPagarMiTramite");
  const parrafo = document.querySelector(".confirmacion");
  if (btnPagar) {
    btnPagar.addEventListener("click", (e) => {
      e.preventDefault();
      console.log("¬°Bot√≥n de pagar presionado!");

      // 1) Ocultamos el bot√≥n
      btnPagar.style.display = "none";
      parrafo.style.display = "none";

      // 2) Mostramos el contenedor donde ir√° el iframe
      const iframeContainer = document.getElementById("iframePagoContainer");
      if (iframeContainer) {
        iframeContainer.style.display = "block"; // De none => block

        // 3) Construimos la URL al cadenacifrada
        //    OJO: Ajusta 'tramite' si quieres algo distinto a "acuatica"
        const tramite = btnPagar.dataset.tramite || "giro";
        const urlCifrado =
          "http://localhost/dashboard/tramites-sjr/PagosMotor/cadenacifrada.php?tramite=" +
          encodeURIComponent(tramite);

        // 4) Pagos gen√©ricos con param "url"
        const urlPagos =
          "http://localhost/dashboard/tramites-sjr/PagosMotor/pagos_genericos.html?url=" +
          encodeURIComponent(urlCifrado);

        // 5) Inyectamos el iframe directamente con esa URL
        iframeContainer.innerHTML = `
          <iframe 
            id="payment-iframe"
            src="${urlPagos}"
            style="width:1000px; height: 1000px; border:none; border-radius:10px;
            justify-content: center;
        align-items: center;"
          ></iframe>
        `;
      }
    });
  }


</script>

</body>
<script src="js/factibilidadGiro.js"></script>
<script src="js/mapaUbiGiro.js"></script>
<script src="js/docsGiro.js"></script>
<script src="js/validacionesGiro.js"></script>
<script src="js/APIGiro.js"></script>

</html>